# ukernel
仿照elephant-OS从零开始完成一个简易的操作系统内核，在设计上参考Linux内核。启动流程为：MBR->Loader->Kernel，在Kernel中依次完成进线程调度，内核/用户内存管理，文件系统等重要模块。

## 启动流程
MBR->Loader->kernel
- MBR：0磁道1扇区的512字节，包括446字节的指令代码，64字节的分区表，2字节的结束码(0xaa,0x55)
- Loader：在从MBR获取控制权之后，将Kernel指令代码从磁盘中加载到内存中，并从实模式过渡到保护模式，开启分页机制
- Kernel：运行内核代码

## 进线程资源管理以及调度
使用struct task_struct保存进/线程的资源，根据PCB中链表结点在不同的链表中决定是否被调度。调度方式暂时选择最简单的定时调度：根据时钟中断的间隔来选择是否被调度。

## 内存管理
从四个角度分配内存：向内核分配物理地址，向内核分配虚拟地址，向用户分配物理地址，向用户分配虚拟地址。

## 文件系统
从两个角度解释扇区中的数据：内核->文件系统；文件系统->磁盘

## 开发计划：
- 根据jemalloc中描述的内存分配机制优化用户进程内存分配机制
- 引入Linux Kernel中的伙伴系统与slob，优化内核内存分配
- 增加VFS层，增加其余的进程间通信方式（已实现pipe）
- 优化文件系统的写入，写出操作，模仿电梯算法
- 优化PCB的调度方式，从非抢占式->抢占式，根据内核定位选择调度方式
- 实现权限管理
